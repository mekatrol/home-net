# ---------------------------------------------------------------------------
# Unraid connection
# ---------------------------------------------------------------------------
host="nas.lan"      # Unraid host name or IP
user="admin"        # SSH user (key-based authentication is assumed)
pwd=""              # Ignored; key-based SSH is used. Leave blank.

# ---------------------------------------------------------------------------
# Power / stability thresholds
# ---------------------------------------------------------------------------

# How long mains power + battery voltage must be continuously OK
# before we are allowed to (re)start the array (seconds).
power_stable_time=180      # 3 minutes

# Battery voltage at which we stop the Unraid array (in Volts).
# When the UPS reports battery_voltage <= LOW_BATT_VOLT while on battery,
# the script will send a "Stop array" request to Unraid (via update.htm).
low_batt_volt=24.7

# Battery voltage at which we shut down the Unraid host (in Volts).
# When the UPS reports battery_voltage <= EXTRA_LOW_BATT_VOLT while on
# battery, the script will send a "Shutdown" request to Unraid.
extra_low_batt_volt=22.5

# Battery voltage threshold that must be reached AFTER power has returned.
# When UPS is back on mains AND battery_voltage >= ENABLE_ARRAY_VOLTAGE
# continuously for at least "power_stable_time" seconds,
# the script will start the Unraid array.
enable_array_voltage=23.0

# ---------------------------------------------------------------------------
# UPS USB interface
# ---------------------------------------------------------------------------

# USB vendor/product ID of the MEC0003 UPS bridge in hexadecimal.
# These values are read by the script and converted to integers.
ups_vendor_id="0001"
ups_product_id="0000"

# USB control-transfer timeout in milliseconds.
ups_timeout_ms=5000

# How often to poll the UPS for status (seconds).
# This controls:
#   - How often we read on_battery/battery_voltage
#   - The granularity of timers derived from UPS data
ups_poll_interval=2

# Whether to automatically silence the UPS beeper once per outage.
# true  -> attempt to send the Megatec "Q" command to toggle beeper off
# false -> leave beeper behavior untouched
silence_beeper=true

# ---------------------------------------------------------------------------
# Unraid monitoring
# ---------------------------------------------------------------------------

# How often to poll Unraid array status (seconds).
# This is independent from UPS polling; Unraid status is checked
# periodically on top of the UPS loop.
status_check_interval=10

# ---------------------------------------------------------------------------
# MQTT publishing
# ---------------------------------------------------------------------------

# Set to true to enable MQTT publishing of UPS info and array status.
mqtt_enabled=true

# MQTT broker connection details.
mqtt_host="mqtt.lan"       # hostname or IP of MQTT broker
mqtt_port=1883             # MQTT port (default 1883)
mqtt_keepalive=30          # MQTT keepalive in seconds

# Optional authentication.
mqtt_username=""           # leave empty for no auth
mqtt_password=""           # leave empty for no auth

# Whether to use TLS. If true, basic TLS will be enabled (system CA).
mqtt_tls=false

# Base topic under which UPS and array messages will be published.
# Final topics:
#   <mqtt_base_topic>/ups
#   <mqtt_base_topic>/array
mqtt_base_topic="home/nas"
